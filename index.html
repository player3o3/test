<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AntiScam.net</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body class="bg-gray-900 min-h-screen flex flex-col items-center p-4 text-white font-sans">

  <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
  <div id="menu" class="w-full max-w-md flex flex-col gap-4 mb-4">

    <!-- –®–∞–ø–∫–∞ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <div class="mb-4 p-4 text-center bg-gray-800 rounded-2xl">
      <h1 class="text-2xl font-bold text-blue-400 mb-2">AntiScam.net</h1>

      <!-- –ü—Ä–æ—Ñ–∏–ª—å (–∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥) -->
      <div onclick="goToPage('profile')" class="flex items-center justify-center gap-4 cursor-pointer bg-gray-700 p-2 rounded-xl hover:bg-gray-600 transition">
        <img id="avatar" src="https://via.placeholder.com/50" alt="–ê–≤–∞—Ç–∞—Ä" class="w-12 h-12 rounded-full">
        <div class="flex flex-col text-left">
          <span id="name" class="font-bold text-lg">–ò–º—è</span>
          <span id="username" class="text-gray-300">@username</span>
          <span id="gameid" class="text-gray-400 text-sm">ID: ...</span>
        </div>
      </div>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∏ -->
    <button onclick="goToPage('cars')" class="py-6 bg-gray-700 hover:bg-gray-600 rounded-xl shadow-lg transition font-bold text-lg">
      üèé –†—ã–Ω–æ–∫ –∞–≤—Ç–æ
    </button>
    <button onclick="goToPage('parts')" class="py-6 bg-gray-700 hover:bg-gray-600 rounded-xl shadow-lg transition font-bold text-lg">
      üîß –†—ã–Ω–æ–∫ –∑–∞–ø—á–∞—Å—Ç–∏
    </button>

    <!-- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å -->
    <div class="w-full h-px bg-gray-700"></div>

    <button onclick="goToPage('exchange')" class="py-6 bg-gray-700 hover:bg-gray-600 rounded-xl shadow-lg transition font-bold text-lg">
      üí± –û–±–º–µ–Ω–Ω–∏–∫
    </button>

    <!-- –í–µ—Ä—Å–∏—è -->
    <p class="text-center text-gray-500 text-sm mt-4">v0.5</p>
  </div>

  <!-- –°—Ç—Ä–∞–Ω–∏—Ü—ã -->
  <div id="cars" class="hidden w-full max-w-md text-white">
    <h2 class="text-2xl font-bold mb-2">üèé –†—ã–Ω–æ–∫ –∞–≤—Ç–æ</h2>
    <p>–ó–¥–µ—Å—å –±—É–¥—É—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–æ –º–∞—à–∏–Ω–∞–º.</p>
    <button onclick="goHome()" class="mt-4 py-2 px-4 bg-gray-700 hover:bg-gray-600 rounded-lg">‚¨ÖÔ∏è –ù–∞–∑–∞–¥</button>
  </div>

  <div id="parts" class="hidden w-full max-w-md text-white">
    <h2 class="text-2xl font-bold mb-2">üîß –†—ã–Ω–æ–∫ –∑–∞–ø—á–∞—Å—Ç–∏</h2>
    <p>–ó–¥–µ—Å—å –±—É–¥—É—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–æ –∑–∞–ø—á–∞—Å—Ç—è–º.</p>
    <button onclick="goHome()" class="mt-4 py-2 px-4 bg-gray-700 hover:bg-gray-600 rounded-lg">‚¨ÖÔ∏è –ù–∞–∑–∞–¥</button>
  </div>

  <div id="exchange" class="hidden w-full max-w-md text-white">
    <h2 class="text-2xl font-bold mb-2">üí± –û–±–º–µ–Ω–Ω–∏–∫</h2>
    <p>–û–±–º–µ–Ω –≤–∞–ª—é—Ç–æ–π.</p>
    <button onclick="goHome()" class="mt-4 py-2 px-4 bg-gray-700 hover:bg-gray-600 rounded-lg">‚¨ÖÔ∏è –ù–∞–∑–∞–¥</button>
  </div>

  <div id="profile" class="hidden w-full max-w-md text-white">
    <h2 class="text-2xl font-bold mb-2">üë§ –ü—Ä–æ—Ñ–∏–ª—å</h2>
    <p>–ò–º—è: <span id="profile-name"></span></p>
    <p>–Æ–∑–µ—Ä–Ω–µ–π–º: <span id="profile-username"></span></p>
    <p>ID –∏–≥—Ä—ã: <span id="profile-gameid">...</span></p>
    <button onclick="goHome()" class="mt-4 py-2 px-4 bg-gray-700 hover:bg-gray-600 rounded-lg">‚¨ÖÔ∏è –ù–∞–∑–∞–¥</button>
  </div>

  <script>
    const pages = ['cars', 'parts', 'exchange', 'profile'];

    function goToPage(name) {
      document.getElementById('menu').classList.add('hidden');
      pages.forEach(p => {
        document.getElementById(p).classList.toggle('hidden', p !== name);
      });
    }

    function goHome() {
      pages.forEach(p => document.getElementById(p).classList.add('hidden'));
      document.getElementById('menu').classList.remove('hidden');
    }

    // Telegram WebApp
    window.Telegram.WebApp.ready();
    const user = window.Telegram.WebApp.initDataUnsafe?.user;

    async function initProfile() {
      let allowedDB = {};

      try {
        const response = await fetch('allowed.json'); // —Ç–≤–æ–π –ø—É—Ç—å –∫ allowed.json
        allowedDB = await response.json();
      } catch (e) {
        console.error("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å allowed.json", e);
      }

      if (!user) return;

      const fullName = user.last_name ? `${user.first_name} ${user.last_name}` : user.first_name;
      const tg_id = user.id.toString();

      // –ó–∞–ø–æ–ª–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
      document.getElementById('name').innerText = fullName || "–ë–µ–∑ –∏–º–µ–Ω–∏";
      document.getElementById('username').innerText = user.username ? "@" + user.username : "–ë–µ–∑ —é–∑–µ—Ä–Ω–µ–π–º–∞";
      document.getElementById('avatar').src = user.photo_url || "https://via.placeholder.com/50";

      document.getElementById('profile-name').innerText = fullName || "–ë–µ–∑ –∏–º–µ–Ω–∏";
      document.getElementById('profile-username').innerText = user.username ? "@" + user.username : "–ë–µ–∑ —é–∑–µ—Ä–Ω–µ–π–º–∞";

      if (allowedDB[tg_id]) {
        document.getElementById('gameid').innerText = "ID: " + allowedDB[tg_id];
        document.getElementById('profile-gameid').innerText = allowedDB[tg_id];
      } else {
        document.getElementById('gameid').innerText = "ID: –ù–µ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω";
        document.getElementById('profile-gameid').innerText = "–ù–µ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω";
      }
    }

    initProfile();
  </script>

</body>
</html>
